


ARM Macro Assembler    Page 1 


    1 00000000         ;/******************************************************
                       ***********************/
    2 00000000         ;/* SAM7.S: Startup file for Atmel AT91SAM7 device serie
                       s                     */
    3 00000000         ;/******************************************************
                       ***********************/
    4 00000000         ;/* <<< Use Configuration Wizard in Context Menu >>>    
                                             */ 
    5 00000000         ;/******************************************************
                       ***********************/
    6 00000000         ;/* This file is part of the uVision/ARM development too
                       ls.                   */
    7 00000000         ;/* Copyright (c) 2005-2006 Keil Software. All rights re
                       served.               */
    8 00000000         ;/* This software may only be used under the terms of a 
                       valid, current,       */
    9 00000000         ;/* end user licence from KEIL for a compatible version 
                       of KEIL software      */
   10 00000000         ;/* development tools. Nothing else gives you the right 
                       to use this software. */
   11 00000000         ;/******************************************************
                       ***********************/
   12 00000000         
   13 00000000         
   14 00000000         ;/*
   15 00000000         ; *  The SAM7.S code is executed after CPU Reset. This f
                       ile may be 
   16 00000000         ; *  translated with the following SET symbols. In uVisi
                       on these SET 
   17 00000000         ; *  symbols are entered under Options - ASM - Define.
   18 00000000         ; *
   19 00000000         ; *  REMAP: when set the startup code remaps exception v
                       ectors from
   20 00000000         ; *  on-chip RAM to address 0.
   21 00000000         ; *
   22 00000000         ; *  RAM_INTVEC: when set the startup code copies except
                       ion vectors 
   23 00000000         ; *  from on-chip Flash to on-chip RAM.
   24 00000000         ; */
   25 00000000         
   26 00000000                 GET              util.s
    1 00000000                 GET              defines.s
    1 00000000         ; Standard definitions of Mode bits and Interrupt (I & F
                       ) flags in PSRs
    2 00000000         
    3 00000000 00000010 
                       Mode_USR
                               EQU              0x10
    4 00000000 00000011 
                       Mode_FIQ
                               EQU              0x11
    5 00000000 00000012 
                       Mode_IRQ
                               EQU              0x12
    6 00000000 00000013 
                       Mode_SVC
                               EQU              0x13
    7 00000000 00000017 
                       Mode_ABT



ARM Macro Assembler    Page 2 


                               EQU              0x17
    8 00000000 0000001B 
                       Mode_UND
                               EQU              0x1B
    9 00000000 0000001F 
                       Mode_SYS
                               EQU              0x1F
   10 00000000         
   11 00000000 00000080 
                       I_Bit   EQU              0x80        ; when I bit is set
                                                            , IRQ is disabled
   12 00000000 00000040 
                       F_Bit   EQU              0x40        ; when F bit is set
                                                            , FIQ is disabled
   13 00000000         
   14 00000000         ; Internal Memory Base Addresses
   15 00000000 00100000 
                       FLASH_BASE
                               EQU              0x00100000
   16 00000000 00200000 
                       RAM_BASE
                               EQU              0x00200000
   17 00000000         
   18 00000000 00000000 
                       UND_Stack_Size
                               EQU              0x00000000
   19 00000000 00000008 
                       SVC_Stack_Size
                               EQU              0x00000008
   20 00000000 00000000 
                       ABT_Stack_Size
                               EQU              0x00000000
   21 00000000 00000000 
                       FIQ_Stack_Size
                               EQU              0x00000000
   22 00000000 00000080 
                       IRQ_Stack_Size
                               EQU              0x00000080
   23 00000000 00000400 
                       USR_Stack_Size
                               EQU              0x00000400
   24 00000000         
   26 00000000 00000088 
                       ISR_Stack_Size
                               EQU              (UND_Stack_Size + SVC_Stack_Siz
e + ABT_Stack_Size +                           FIQ_Stack_Size + IRQ_Stack_Size
)
   27 00000000         
   28 00000000 00000000 
                       Heap_Size
                               EQU              0x00000000
   29 00000000         
   30 00000000         
   31 00000000         
   32 00000000         ; Reset Controller (RSTC) definitions
   33 00000000 FFFFFD00 
                       RSTC_BASE
                               EQU              0xFFFFFD00  ; RSTC Base Address
                                                            



ARM Macro Assembler    Page 3 


   34 00000000 00000008 
                       RSTC_MR EQU              0x08        ; RSTC_MR Offset
   35 00000000         
   36 00000000         
   37 00000000 00000001 
                       RSTC_SETUP
                               EQU              1
   38 00000000 A5000401 
                       RSTC_MR_Val
                               EQU              0xA5000401
   39 00000000         
   40 00000000         
   41 00000000         ; Embedded Flash Controller (EFC) definitions
   42 00000000 FFFFFF00 
                       EFC_BASE
                               EQU              0xFFFFFF00  ; EFC Base Address
   43 00000000 00000060 
                       EFC0_FMR
                               EQU              0x60        ; EFC0_FMR Offset
   44 00000000 00000070 
                       EFC1_FMR
                               EQU              0x70        ; EFC1_FMR Offset
   45 00000000         
   46 00000000 00000001 
                       EFC0_SETUP
                               EQU              1
   47 00000000 00320100 
                       EFC0_FMR_Val
                               EQU              0x00320100
   48 00000000         
   49 00000000 00000000 
                       EFC1_SETUP
                               EQU              0
   50 00000000 00320100 
                       EFC1_FMR_Val
                               EQU              0x00320100
   51 00000000         
   52 00000000         
   53 00000000         ; Watchdog Timer (WDT) definitions
   54 00000000 FFFFFD40 
                       WDT_BASE
                               EQU              0xFFFFFD40  ; WDT Base Address
   55 00000000 00000004 
                       WDT_MR  EQU              0x04        ; WDT_MR Offset
   56 00000000 00000001 
                       WDT_SETUP
                               EQU              1
   57 00000000 00008000 
                       WDT_MR_Val
                               EQU              0x00008000
   58 00000000         
   59 00000000         ; Power Mangement Controller (PMC) definitions
   60 00000000 FFFFFC00 
                       PMC_BASE
                               EQU              0xFFFFFC00  ; PMC Base Address
   61 00000000 00000010 
                       PMC_PCER
                               EQU              0x10
   62 00000000 00000020 



ARM Macro Assembler    Page 4 


                       PMC_MOR EQU              0x20        ; PMC_MOR Offset
   63 00000000 00000024 
                       PMC_MCFR
                               EQU              0x24        ; PMC_MCFR Offset
   64 00000000 0000002C 
                       PMC_PLLR
                               EQU              0x2C        ; PMC_PLLR Offset
   65 00000000 00000030 
                       PMC_MCKR
                               EQU              0x30        ; PMC_MCKR Offset
   66 00000000 00000068 
                       PMC_SR  EQU              0x68        ; PMC_SR Offset
   67 00000000 00000001 
                       PMC_MOSCEN
                               EQU              (1<<0)      ; Main Oscillator E
                                                            nable
   68 00000000 00000002 
                       PMC_OSCBYPASS
                               EQU              (1<<1)      ; Main Oscillator B
                                                            ypass
   69 00000000 0000FF00 
                       PMC_OSCOUNT
                               EQU              (0xFF<<8)   ; Main OScillator S
                                                            tart-up Time
   70 00000000 000000FF 
                       PMC_DIV EQU              (0xFF<<0)   ; PLL Divider
   71 00000000 00003F00 
                       PMC_PLLCOUNT
                               EQU              (0x3F<<8)   ; PLL Lock Counter
   72 00000000 0000C000 
                       PMC_OUT EQU              (0x03<<14)  ; PLL Clock Frequen
                                                            cy Range
   73 00000000 07FF0000 
                       PMC_MUL EQU              (0x7FF<<16) ; PLL Multiplier
   74 00000000 30000000 
                       PMC_USBDIV
                               EQU              (0x03<<28)  ; USB Clock Divider
                                                            
   75 00000000 00000003 
                       PMC_CSS EQU              (3<<0)      ; Clock Source Sele
                                                            ction
   76 00000000 0000001C 
                       PMC_PRES
                               EQU              (7<<2)      ; Prescaler Selecti
                                                            on
   77 00000000 00000001 
                       PMC_MOSCS
                               EQU              (1<<0)      ; Main Oscillator S
                                                            table
   78 00000000 00000004 
                       PMC_LOCK
                               EQU              (1<<2)      ; PLL Lock Status
   79 00000000 00000008 
                       PMC_MCKRDY
                               EQU              (1<<3)      ; Master Clock Stat
                                                            us
   80 00000000 00000001 
                       PMC_SETUP
                               EQU              1



ARM Macro Assembler    Page 5 


   81 00000000 00000601 
                       PMC_MOR_Val
                               EQU              0x00000601
   82 00000000 00191C05 
                       PMC_PLLR_Val
                               EQU              0x00191C05
   83 00000000 00000007 
                       PMC_MCKR_Val
                               EQU              0x00000007
   84 00000000         
   85 00000000         
   86 00000000         ; Адреса периферийных устройств
   87 00000000 FFFFF400 
                       PIOA_BASE
                               EQU              0xFFFFF400  ; Порт "А"
   88 00000000 FFFFF600 
                       PIOB_BASE
                               EQU              0xFFFFF600  ; Порт "В"
   89 00000000 FFFFF200 
                       DBGU_BASE
                               EQU              0xFFFFF200  ; Отладочный UART
   90 00000000         
   91 00000000         ; Смещения регистров периферийных устройств
   92 00000000         
   93 00000000         ; Порты ввода-выводы
   94 00000000 00000004 
                       PIO_PDR EQU              0x0004
   95 00000000 00000010 
                       PIO_OER EQU              0x0010
   96 00000000 00000014 
                       PIO_ODR EQU              0x0014
   97 00000000 00000024 
                       PIO_IFDR
                               EQU              0x0024
   98 00000000 00000030 
                       PIO_SODR
                               EQU              0x0030
   99 00000000 00000034 
                       PIO_CODR
                               EQU              0x0034
  100 00000000 00000070 
                       PIO_ASR EQU              0x0070
  101 00000000 00000074 
                       PIO_BSR EQU              0x0074
  102 00000000         
  103 00000000         ; Отладочный UART
  104 00000000         
  105 00000000 00000000 
                       DBGU_CR EQU              0x00000000
  106 00000000 00000004 
                       DBGU_MR EQU              0x00000004
  107 00000000 00000014 
                       DBGU_CSR
                               EQU              0x00000014
  108 00000000 0000001C 
                       DBGU_THR
                               EQU              0x0000001C
  109 00000000 0000000C 
                       DBGU_IDR



ARM Macro Assembler    Page 6 


                               EQU              0x0000000C
  110 00000000 00000020 
                       DBGU_BRGR
                               EQU              0x00000020
  111 00000000         
  112 00000000         ; DMA для отладочного UART'a
  113 00000000         
  114 00000000 FFFFF300 
                       DBGU_PDC_BASE
                               EQU              0xFFFFF300
  115 00000000 00000020 
                       DBGU_PDC_PTCR
                               EQU              0x00000020
  116 00000000         
  117 00000000         ; USART0
  118 00000000         
  119 00000000 FFFC0000 
                       USART0_BASE
                               EQU              0xFFFC0000
  120 00000000 00000000 
                       USART_CR
                               EQU              0x0000
  121 00000000 00000004 
                       USART_MR
                               EQU              0x0004
  122 00000000 00000014 
                       USART_CSR
                               EQU              0x0014
  123 00000000 0000001C 
                       USART_THR
                               EQU              0x001C
  124 00000000 00000020 
                       USART_BRGR
                               EQU              0x0020
  125 00000000 0000000C 
                       USART_IDR
                               EQU              0x000C
  126 00000000         
  127 00000000         ; AIC
  128 00000000         
  129 00000000 FFFFF000 
                       AIC_BASE
                               EQU              0xFFFFF000
  130 00000000 00000004 
                       AIC_SMR1
                               EQU              0x0004
  131 00000000 00000084 
                       AIC_SVR1
                               EQU              0x0084
  132 00000000 00000110 
                       AIC_IMR EQU              0x0110
  133 00000000 00000120 
                       AIC_IECR
                               EQU              0x0120
  134 00000000 00000128 
                       AIC_ICCR
                               EQU              0x0128
  135 00000000 00000130 
                       AIC_EOICR



ARM Macro Assembler    Page 7 


                               EQU              0x0130
  136 00000000         
  137 00000000         ; PIT
  138 00000000 FFFFFD30 
                       PIT_BASE
                               EQU              0xFFFFFD30
  139 00000000 00000000 
                       PIT_MR  EQU              0x00
  140 00000000 00000004 
                       PIT_SR  EQU              0x04
  141 00000000 00000008 
                       PIT_PIVR
                               EQU              0x08
  142 00000000 0000000C 
                       PIT_PIIR
                               EQU              0x0C
  143 00000000         
  144 00000000         
  145 00000000         
  146 00000000                 END
    2 00000000                 AREA             Util, CODE, READONLY, ALIGN=3
    3 00000000         
    4 00000000         BLINKDELAY
                               PROC
    5 00000000         
    6 00000000 E52DE004        PUSH             {LR}
    7 00000004 E52D0004        PUSH             {R0}
    8 00000008 E52D1004        PUSH             {R1}
    9 0000000C         
   10 0000000C E3A00064        MOV              R0, #100
   11 00000010 E1A00400        LSL              R0, #8
   12 00000014         DELAY_1
   13 00000014 E2400001        SUB              R0, #1
   14 00000018         ;MOV R1, #200
   15 00000018 E3A01032        MOV              R1, #50
   16 0000001C         
   17 0000001C         DELAY_2
   18 0000001C E2411001        SUB              R1, #1
   19 00000020 E3510000        CMP              R1, #0
   20 00000024 1AFFFFFC        BNE              DELAY_2
   21 00000028         
   22 00000028 E3500000        CMP              R0,#0
   23 0000002C 1AFFFFF8        BNE              DELAY_1
   24 00000030         
   25 00000030 E49D1004        POP              {R1}
   26 00000034 E49D0004        POP              {R0}
   27 00000038 E49DF004        POP              {PC}
   28 0000003C         
   29 0000003C                 ENDP
   30 0000003C         
   31 0000003C         ; Отправка символа по UART
   32 0000003C         ; ВХОД: R2 - отправляемый символ
   33 0000003C         UART_SEND_CHR
                               PROC
   34 0000003C         
   35 0000003C E52DE004        PUSH             {LR}
   36 00000040 E52D0004        PUSH             {R0}
   37 00000044 E52D1004        PUSH             {R1}
   38 00000048 E52D2004        PUSH             {R2}



ARM Macro Assembler    Page 8 


   39 0000004C         
   40 0000004C E59F0150        LDR              R0, =USART0_BASE
   41 00000050 E1A01002        MOV              R1, R2
   42 00000054 E580101C        STR              R1, [R0, #USART_THR]
   43 00000058         
   44 00000058         ; Дожидаемся окончания отправки
   45 00000058         
   46 00000058         WAIT_SENT
   47 00000058 E0200000        EOR              R0, R0
   48 0000005C E2400701        ADD              R0, #USART0_BASE
   49 00000060 E2800014        ADD              R0, #USART_CSR
   50 00000064 E5901000        LDR              R1, [R0]
   51 00000068 E3A02001        MOV              R2, #1
   52 0000006C E1A02482        LSL              R2, #9
   53 00000070 E1110002        TST              R1, R2      ; бит "передача зав
                                                            ершена"
   54 00000074 0AFFFFF7        BEQ              WAIT_SENT
   55 00000078         
   56 00000078 E49D2004        POP              {R2}
   57 0000007C E49D1004        POP              {R1}
   58 00000080 E49D0004        POP              {R0}
   59 00000084 E49DF004        POP              {PC}
   60 00000088         
   61 00000088                 ENDP
   62 00000088         
   63 00000088         
   64 00000088         ; Отправка строки по UART
   65 00000088         ; ВХОД: R0 - адрес строки
   66 00000088         UART_SEND_STR
                               PROC
   67 00000088         
   68 00000088 E52DE004        PUSH             {LR}
   69 0000008C E52D0004        PUSH             {R0}
   70 00000090 E52D1004        PUSH             {R1}
   71 00000094 E52D2004        PUSH             {R2}
   72 00000098         
   73 00000098         
   74 00000098         NEXT_CHR
   75 00000098 E5D02000        LDRB             R2, [R0]
   76 0000009C E3520000        CMP              R2, #0
   77 000000A0 0A000002        BEQ              STR_END
   78 000000A4 EBFFFFFE        BL               UART_SEND_CHR
   79 000000A8 E2800001        ADD              R0, #1
   80 000000AC EAFFFFF9        B                NEXT_CHR
   81 000000B0         STR_END
   82 000000B0 E49D2004        POP              {R2}
   83 000000B4 E49D1004        POP              {R1}
   84 000000B8 E49D0004        POP              {R0}
   85 000000BC E49DF004        POP              {PC}
   86 000000C0                 ENDP
   87 000000C0         
   88 000000C0         ; Send HEX digit to UART
   89 000000C0         ; INPUT: R2 as DIGIT
   90 000000C0         WRITE_DIGIT_HEX
   91 000000C0 E52DE004        PUSH             {LR}
   92 000000C4 E52D2004        PUSH             {R2}
   93 000000C8         
   94 000000C8 E202200F        AND              R2, #0x0F
   95 000000CC E3520009        CMP              R2, #0x09



ARM Macro Assembler    Page 9 


   96 000000D0 CA000003        BGT              GREATER_THAN9
   97 000000D4 E2822030        ADD              R2, #0x30
   98 000000D8 EBFFFFFE        BL               UART_SEND_CHR
   99 000000DC         
  100 000000DC E49D2004        POP              {R2}
  101 000000E0 E49DF004        POP              {PC}
  102 000000E4         
  103 000000E4         GREATER_THAN9
  104 000000E4 E2822037        ADD              R2, #0x37
  105 000000E8 EBFFFFFE        BL               UART_SEND_CHR
  106 000000EC E49D2004        POP              {R2}
  107 000000F0 E49DF004        POP              {PC}
  108 000000F4         
  109 000000F4         ; R2 - byte to write
  110 000000F4         WRITE_BYTE_HEX
  111 000000F4 E52DE004        PUSH             {LR}
  112 000000F8 E52D1004        PUSH             {R1}
  113 000000FC E52D2004        PUSH             {R2}
  114 00000100         
  115 00000100 E0211001        EOR              R1, R1
  116 00000104 E1A01002        MOV              R1, R2
  117 00000108 E52D1004        PUSH             {R1}
  118 0000010C E52D2004        PUSH             {R2}
  119 00000110 E1A02222        LSR              R2, #4
  120 00000114 EBFFFFE9        BL               WRITE_DIGIT_HEX
  121 00000118 E49D2004        POP              {R2}
  122 0000011C E49D1004        POP              {R1}
  123 00000120 E1A02001        MOV              R2, R1
  124 00000124 EBFFFFE5        BL               WRITE_DIGIT_HEX
  125 00000128         
  126 00000128 E49D2004        POP              {R2}
  127 0000012C E49D1004        POP              {R1}
  128 00000130 E49DF004        POP              {PC}
  129 00000134         
  130 00000134         DisablePIT
                               PROC
  131 00000134         
  132 00000134 E52DE004        PUSH             {LR}
  133 00000138 E52D0004        PUSH             {R0}
  134 0000013C E52D1004        PUSH             {R1}
  135 00000140 E52D2004        PUSH             {R2}
  136 00000144         
  137 00000144         ; Disable timer interrupt    
  138 00000144 E59F005C        LDR              R0, =PIT_BASE
  139 00000148         ; Clear PITIEN bit
  140 00000148 E3A01001        MOV              R1, #1
  141 0000014C E1A01C81        LSL              R1, #25
  142 00000150         
  143 00000150         ; Load to R2 PIT_MR state
  144 00000150 E5902000        LDR              R2, [R0, #PIT_MR]
  145 00000154 E1C22001        BIC              R2, R1
  146 00000158 E5802000        STR              R2, [R0, #PIT_MR]
  147 0000015C         
  148 0000015C E49D2004        POP              {R2}
  149 00000160 E49D1004        POP              {R1}
  150 00000164 E49D0004        POP              {R0}
  151 00000168 E49DF004        POP              {PC}
  152 0000016C         
  153 0000016C                 ENDP



ARM Macro Assembler    Page 10 


  154 0000016C         
  155 0000016C         EnablePIT
                               PROC
  156 0000016C         
  157 0000016C E52DE004        PUSH             {LR}
  158 00000170 E52D0004        PUSH             {R0}
  159 00000174 E52D1004        PUSH             {R1}
  160 00000178 E52D2004        PUSH             {R2}
  161 0000017C         
  162 0000017C         ; Disable timer interrupt    
  163 0000017C E59F0024        LDR              R0, =PIT_BASE
  164 00000180         ; Clear PITIEN bit
  165 00000180 E3A01001        MOV              R1, #1
  166 00000184 E1A01C81        LSL              R1, #25
  167 00000188         
  168 00000188         ; Load to R2 PIT_MR state
  169 00000188 E5902000        LDR              R2, [R0, #PIT_MR]
  170 0000018C E1822001        ORR              R2, R1
  171 00000190 E5802000        STR              R2, [R0, #PIT_MR]
  172 00000194         
  173 00000194 E49D2004        POP              {R2}
  174 00000198 E49D1004        POP              {R1}
  175 0000019C E49D0004        POP              {R0}
  176 000001A0 E49DF004        POP              {PC}
  177 000001A4         
  178 000001A4                 ENDP
  179 000001A4         
  180 000001A4                 END
   27 000001A4         
   28 000001A4 FFFC0000 
              FFFFFD30         AREA             STACK, NOINIT, READWRITE, ALIGN
=3
   29 00000000         
   30 00000000         Stack_Mem
                               SPACE            USR_Stack_Size
   31 00000400         __initial_sp
                               SPACE            ISR_Stack_Size
   32 00000488         Stack_Top
   33 00000488         
   34 00000488         Task1_Stack_Mem
                               SPACE            0x00000100
   35 00000588         Task1_Stack_Top
   36 00000588         
   37 00000588         Task2_Stack_Mem
                               SPACE            0x00000100
   38 00000688         Task2_Stack_Top
   39 00000688         
   40 00000688         Task3_Stack_Mem
                               SPACE            0x00000100
   41 00000788         Task3_Stack_Top
   42 00000788         
   43 00000788         
   44 00000788                 AREA             HEAP, NOINIT, READWRITE, ALIGN=
3
   45 00000000         __heap_base
   46 00000000         Heap_Mem
                               SPACE            Heap_Size
   47 00000000         __heap_limit
   48 00000000         



ARM Macro Assembler    Page 11 


   49 00000000         
   50 00000000                 PRESERVE8
   51 00000000         
   52 00000000         
   53 00000000                 AREA             DATA, DATA, READONLY, ALIGN=3
   54 00000000         ;AREA    DATA, DATA, READWRITE, ALIGN=3
   55 00000000 48 65 6C 
              6C 6F 20 
              66 72 6F 
              6D 20 70 
              72 6F 67 
              72 61 6D 
              20 62 6F 
              64 79 0A 
              0D 00    Msg     DCB              "Hello from program body", 10, 
13, 0
   56 0000001A 48 65 6C 
              6C 6F 20 
              66 72 6F 
              6D 20 49 
              52 51 0A 
              0D 00    IRQMsg  DCB              "Hello from IRQ", 10, 13, 0
   57 0000002B 0A 0D 00 
                       CRLF    DCB              10, 13, 0
   58 0000002E         
   59 0000002E 54 41 53 
              4B 31 3A 
              20 00    Task1Msg
                               DCB              "TASK1: ", 0
   60 00000036 54 41 53 
              4B 32 3A 
              20 00    Task2Msg
                               DCB              "TASK2: ", 0
   61 0000003E 54 41 53 
              4B 33 3A 
              20 00    Task3Msg
                               DCB              "TASK3: ", 0
   62 00000046 54 61 73 
              6B 20 6F 
              77 6E 20 
              63 6F 75 
              6E 74 65 
              72 3A 20 
              00       TaskCntrMsg
                               DCB              "Task own counter: ", 0
   63 00000059 43 6F 6D 
              6D 6F 6E 
              20 74 61 
              73 6B 20 
              63 6F 75 
              6E 74 65 
              72 3A 20 
              00       CommonCntrMsg
                               DCB              "Common task counter: ", 0
   64 0000006F         
   65 0000006F 4E 65 78 
              74 20 74 
              61 73 6B 
              3A 20 00 ShedMsg DCB              "Next task: ", 0



ARM Macro Assembler    Page 12 


   66 0000007B                 PRESERVE8
   67 0000007B         
   68 0000007B                 AREA             Var, DATA, READWRITE, ALIGN=3
   69 00000000 00000000 
              00000000 CommonCounter
                               DCQ              0
   70 00000008 00000000 
              00000000 Task1Counter
                               DCQ              0
   71 00000010 00000000 
              00000000 Task2Counter
                               DCQ              0
   72 00000018 00000000 
              00000000 Task3Counter
                               DCQ              0
   73 00000020 00000001 
              00000000 NextTaskNumber
                               DCQ              1
   74 00000028         ;Dummy1   DCB  0
   75 00000028         ;Dummy2   DCB  0
   76 00000028         ;Dummy3   DCB  0
   77 00000028         
   78 00000028 00000000 
              00000000 Task1SP DCQ              0
   79 00000030 00000000 
              00000000 Task2SP DCQ              0
   80 00000038 00000000 
              00000000 Task3SP DCQ              0
   81 00000040 00000000 
              00000000 SystemSP
                               DCQ              0
   82 00000048                 PRESERVE8
   83 00000048         
   84 00000048         
   85 00000048         ; Area Definition and Entry Point
   86 00000048         ;  Startup Code must be linked first at Address at which
                        it expects to run.
   87 00000048         
   88 00000048                 AREA             RESET, CODE, READONLY
   89 00000000                 ARM
   90 00000000         
   91 00000000         
   92 00000000         ; Exception Vectors
   93 00000000         ;  Mapped to Address 0.
   94 00000000         ;  Absolute addressing mode must be used.
   95 00000000         ;  Dummy Handlers are implemented as infinite loops whic
                       h can be modified.
   96 00000000         
   97 00000000 E59FF018 
                       Vectors LDR              PC,Reset_Addr
   98 00000004 E59FF018        LDR              PC,Undef_Addr
   99 00000008 E59FF018        LDR              PC,SWI_Addr
  100 0000000C E59FF018        LDR              PC,PAbt_Addr
  101 00000010 E59FF018        LDR              PC,DAbt_Addr
  102 00000014 E1A00000        NOP                          ; Reserved Vector
  103 00000018         ;               LDR     PC,IRQ_Addr
  104 00000018 E51FFF20        LDR              PC,[PC,#-0xF20] ; Vector From A
                                                            IC_IVR
  105 0000001C         ;               LDR     PC,FIQ_Addr



ARM Macro Assembler    Page 13 


  106 0000001C E51FFF20        LDR              PC,[PC,#-0xF20] ; Vector From A
                                                            IC_FVR
  107 00000020         
  108 00000020 00000000 
                       Reset_Addr
                               DCD              Reset_Handler
  109 00000024 00000000 
                       Undef_Addr
                               DCD              Undef_Handler
  110 00000028 00000000 
                       SWI_Addr
                               DCD              SWI_Handler
  111 0000002C 00000000 
                       PAbt_Addr
                               DCD              PAbt_Handler
  112 00000030 00000000 
                       DAbt_Addr
                               DCD              DAbt_Handler
  113 00000034 00000000        DCD              0           ; Reserved Address
  114 00000038 00000000 
                       IRQ_Addr
                               DCD              IRQ_Handler
  115 0000003C 00000000 
                       FIQ_Addr
                               DCD              FIQ_Handler
  116 00000040         
  117 00000040 EAFFFFFE 
                       Undef_Handler
                               B                Undef_Handler
  118 00000044 EAFFFFFE 
                       SWI_Handler
                               B                SWI_Handler
  119 00000048 EAFFFFFE 
                       PAbt_Handler
                               B                PAbt_Handler
  120 0000004C EAFFFFFE 
                       DAbt_Handler
                               B                DAbt_Handler
  121 00000050         
  122 00000050         
  123 00000050         IRQ_Handler
  124 00000050 EA0000DD        B                Timer_IRQ
  125 00000054         
  126 00000054         
  127 00000054 EAFFFFFE 
                       FIQ_Handler
                               B                FIQ_Handler
  128 00000058         
  129 00000058         
  130 00000058         ; Reset Handler
  131 00000058         
  132 00000058                 EXPORT           Reset_Handler
  133 00000058         Reset_Handler
  134 00000058         
  135 00000058         
  136 00000058         ; Setup PMC
  137 00000058                 IF               PMC_SETUP != 0
  138 00000058 E59F03C0        LDR              R0, =PMC_BASE
  139 0000005C         



ARM Macro Assembler    Page 14 


  140 0000005C         ;  Setup Main Oscillator
  141 0000005C E59F13C0        LDR              R1, =PMC_MOR_Val
  142 00000060 E5801020        STR              R1, [R0, #PMC_MOR]
  143 00000064         
  144 00000064         ;  Wait until Main Oscillator is stablilized
  145 00000064                 IF               (PMC_MOR_Val:AND:PMC_MOSCEN) !=
 0
  146 00000064 E5902068 
                       MOSCS_Loop
                               LDR              R2, [R0, #PMC_SR]
  147 00000068 E2122001        ANDS             R2, R2, #PMC_MOSCS
  148 0000006C 0AFFFFFC        BEQ              MOSCS_Loop
  149 00000070                 ENDIF
  150 00000070         
  151 00000070         ;  Setup the PLL
  152 00000070                 IF               (PMC_PLLR_Val:AND:PMC_MUL) != 0
  153 00000070 E59F13B0        LDR              R1, =PMC_PLLR_Val
  154 00000074 E580102C        STR              R1, [R0, #PMC_PLLR]
  155 00000078         
  156 00000078         ;  Wait until PLL is stabilized
  157 00000078 E5902068 
                       PLL_Loop
                               LDR              R2, [R0, #PMC_SR]
  158 0000007C E2122004        ANDS             R2, R2, #PMC_LOCK
  159 00000080 0AFFFFFC        BEQ              PLL_Loop
  160 00000084                 ENDIF
  161 00000084         
  162 00000084         ;  Select Clock
  163 00000084                 IF               (PMC_MCKR_Val:AND:PMC_CSS) == 1
 
                                                            ; Main Clock Select
                                                            ed
                               ELIF             (PMC_MCKR_Val:AND:PMC_CSS) == 3
 
                                                            ; PLL  Clock Select
                                                            ed
  176 00000084 E3A01007        LDR              R1, =PMC_MCKR_Val
  177 00000088 E201101C        AND              R1, #PMC_PRES
  178 0000008C E5801030        STR              R1, [R0, #PMC_MCKR]
  179 00000090 E5902068 
                       WAIT_Rdy1
                               LDR              R2, [R0, #PMC_SR]
  180 00000094 E2122008        ANDS             R2, R2, #PMC_MCKRDY
  181 00000098 0AFFFFFC        BEQ              WAIT_Rdy1
  182 0000009C E3A01007        LDR              R1, =PMC_MCKR_Val
  183 000000A0 E5801030        STR              R1, [R0, #PMC_MCKR]
  184 000000A4 E5902068 
                       WAIT_Rdy2
                               LDR              R2, [R0, #PMC_SR]
  185 000000A8 E2122008        ANDS             R2, R2, #PMC_MCKRDY
  186 000000AC 0AFFFFFC        BEQ              WAIT_Rdy2
  187 000000B0                 ENDIF                        ; Select Clock
  188 000000B0                 ENDIF                        ; PMC_SETUP
  189 000000B0         
  190 000000B0         
  191 000000B0         ; Copy Exception Vectors to Internal RAM
  192 000000B0         
  193 000000B0                 IF               :DEF:RAM_INTVEC
  200                          ENDIF



ARM Macro Assembler    Page 15 


  201 000000B0         
  202 000000B0         
  203 000000B0         ; Remap on-chip RAM to address 0
  204 000000B0         
  205 000000B0 FFFFFF00 
                       MC_BASE EQU              0xFFFFFF00  ; MC Base Address
  206 000000B0 00000000 
                       MC_RCR  EQU              0x00        ; MC_RCR Offset
  207 000000B0         
  208 000000B0                 IF               :DEF:REMAP
  212                          ENDIF
  213 000000B0         
  214 000000B0         
  215 000000B0         ; Setup Stack for each mode
  216 000000B0         
  217 000000B0 E59F0374        LDR              R0, =Stack_Top
  218 000000B4         
  219 000000B4         ;  Enter Undefined Instruction Mode and set its Stack Po
                       inter
  220 000000B4 E321F0DB        MSR              CPSR_c, #Mode_UND:OR:I_Bit:OR:F
_Bit
  221 000000B8 E1A0D000        MOV              SP, R0
  222 000000BC E2400000        SUB              R0, R0, #UND_Stack_Size
  223 000000C0         
  224 000000C0         ;  Enter Abort Mode and set its Stack Pointer
  225 000000C0 E321F0D7        MSR              CPSR_c, #Mode_ABT:OR:I_Bit:OR:F
_Bit
  226 000000C4 E1A0D000        MOV              SP, R0
  227 000000C8 E2400000        SUB              R0, R0, #ABT_Stack_Size
  228 000000CC         
  229 000000CC         ;  Enter FIQ Mode and set its Stack Pointer
  230 000000CC E321F0D1        MSR              CPSR_c, #Mode_FIQ:OR:I_Bit:OR:F
_Bit
  231 000000D0 E1A0D000        MOV              SP, R0
  232 000000D4 E2400000        SUB              R0, R0, #FIQ_Stack_Size
  233 000000D8         
  234 000000D8         ;  Enter IRQ Mode and set its Stack Pointer
  235 000000D8 E321F0D2        MSR              CPSR_c, #Mode_IRQ:OR:I_Bit:OR:F
_Bit
  236 000000DC E1A0D000        MOV              SP, R0
  237 000000E0 E2400080        SUB              R0, R0, #IRQ_Stack_Size
  238 000000E4         
  239 000000E4         ;  Enter Supervisor Mode and set its Stack Pointer
  240 000000E4 E321F0D3        MSR              CPSR_c, #Mode_SVC:OR:I_Bit:OR:F
_Bit
  241 000000E8 E1A0D000        MOV              SP, R0
  242 000000EC E2400008        SUB              R0, R0, #SVC_Stack_Size
  243 000000F0         
  244 000000F0         ;  Enter User Mode and set its Stack Pointer
  245 000000F0 E321F010        MSR              CPSR_c, #Mode_USR
  246 000000F4                 IF               :DEF:__MICROLIB
  251 000000F4         
  252 000000F4 E1A0D000        MOV              SP, R0
  253 000000F8 E24DAB01        SUB              SL, SP, #USR_Stack_Size
  254 000000FC         
  255 000000FC                 ENDIF
  256 000000FC         
  257 000000FC         
  258 000000FC         ; ----------------------ТОЧКА ВХОДА ЗДЕСЬ!!!------------



ARM Macro Assembler    Page 16 


                       -----------
  259 000000FC         
  260 000000FC         ENTRYPOINT
  261 000000FC         
  262 000000FC         ; Включение тактирования PIOA
  263 000000FC E59F031C        LDR              R0, =PMC_BASE
  264 00000100 E3A01001        MOV              R1, #1
  265 00000104 E1A01101        LSL              R1, #2
  266 00000108 E5801010        STR              R1, [R0, #PMC_PCER]
  267 0000010C         
  268 0000010C         ; Включение тактирования PIOB
  269 0000010C E59F030C        LDR              R0, =PMC_BASE
  270 00000110 E3A01001        MOV              R1, #1
  271 00000114 E1A01181        LSL              R1, #3
  272 00000118 E5801010        STR              R1, [R0, #PMC_PCER]
  273 0000011C         
  274 0000011C         ; Настройка мультиплекчирования выводов PIOA.1 для работ
                       ы с USART0
  275 0000011C E59F030C        LDR              R0, =PIOA_BASE
  276 00000120 E3A01003        MOV              R1, #3
  277 00000124 E5801070        STR              R1, [R0, #PIO_ASR]
  278 00000128 E5801004        STR              R1, [R0, #PIO_PDR]
  279 0000012C E5801014        STR              R1, [R0, #PIO_ODR]
  280 00000130 E5801024        STR              R1, [R0, #PIO_IFDR]
  281 00000134 E5801034        STR              R1, [R0, #PIO_CODR]
  282 00000138         
  283 00000138         ; Включение PB20 на выход (подсветка LCD)
  284 00000138 E59F02F4        LDR              R0, =PIOB_BASE
  285 0000013C E3A01001        MOV              R1, #1
  286 00000140 E1A01A01        LSL              R1, #20
  287 00000144 E5801010        STR              R1, [R0, #PIO_OER]
  288 00000148         
  289 00000148         ; Включение тактирования USART0
  290 00000148 E59F02D0        LDR              R0, =PMC_BASE
  291 0000014C E3A01001        MOV              R1, #1
  292 00000150 E1A01301        LSL              R1, #6
  293 00000154 E5801010        STR              R1, [R0, #PMC_PCER]
  294 00000158         
  295 00000158         
  296 00000158         ; Настройка USART0
  297 00000158         
  298 00000158         ; Сброс контроллера UART
  299 00000158 E59F02D8        LDR              R0, =USART0_BASE
  300 0000015C E3A010AC        MOV              R1, #0xAC
  301 00000160 E5801000        STR              R1, [R0, #USART_CR]
  302 00000164         
  303 00000164         ; Запрещение выдачи прерываний
  304 00000164 E59F02CC        LDR              R0, =USART0_BASE
  305 00000168 E3E01000        MOV              R1, #0xFFFFFFFF
  306 0000016C E580100C        STR              R1, [R0, #USART_IDR]
  307 00000170         
  308 00000170         ; Режим работы: 8 бит, 1 стоповый бит, без бита четности
                       
  309 00000170 E59F02C0        LDR              R0, =USART0_BASE
  310 00000174 E3A01003        MOV              R1, #3
  311 00000178 E1A01301        LSL              R1, #6
  312 0000017C E3A02004        MOV              R2, #4
  313 00000180 E1A02482        LSL              R2, #9
  314 00000184 E1811002        ORR              R1, R2



ARM Macro Assembler    Page 17 


  315 00000188 E5801004        STR              R1, [R0, #USART_MR]
  316 0000018C         
  317 0000018C         ; Скорость работы: 115200 бод
  318 0000018C E59F02A4        LDR              R0, =USART0_BASE
  319 00000190 E3A0101A        MOV              R1, #26
  320 00000194 E5801020        STR              R1, [R0, #USART_BRGR]
  321 00000198         
  322 00000198 E59F0298        LDR              R0, =USART0_BASE
  323 0000019C E3A01005        MOV              R1, #5
  324 000001A0 E1A01201        LSL              R1, #4
  325 000001A4 E5801000        STR              R1, [R0, #USART_CR]
  326 000001A8         
  327 000001A8         ; Настройка прерывания от системного таймера PIT
  328 000001A8         ; Через AIC-контроллер прерывание подключается ко входу 
                       IRQ ядра
  329 000001A8         ; В регистр вектора прерывания AIC записывается адрес об
                       работчика
  330 000001A8         ; прерывания таймера
  331 000001A8         ; У AT91SAM7X256 прерывание таймера считается системным
  332 000001A8         ; в AIC под системное прерывание выделен номер 1
  333 000001A8         
  334 000001A8 E59F028C        LDR              R0, =AIC_BASE
  335 000001AC E59F128C        LDR              R1, =IRQ_Handler
  336 000001B0 E5801084        STR              R1, [R0, #AIC_SVR1]
  337 000001B4         
  338 000001B4         ; Установка режима реакции входа прерывания
  339 000001B4         ; по восходящему фронту сигнала (бит 5)
  340 000001B4 E59F0280        LDR              R0, =AIC_BASE
  341 000001B8 E3A01001        MOV              R1, #1
  342 000001BC E1A01281        LSL              R1, #5
  343 000001C0 E5801004        STR              R1, [R0, #AIC_SMR1]
  344 000001C4         
  345 000001C4         ; Разрешение системного прерывания в AIC
  346 000001C4 E3A01002        MOV              R1, #0x02
  347 000001C8 E5801120        STR              R1, [R0, #AIC_IECR]
  348 000001CC         
  349 000001CC         ; Инициализация таймера и разрешения выдачи прерывания в
                        AIC
  350 000001CC E3A01003        MOV              R1, #3
  351 000001D0 E1A01C01        LSL              R1, #24
  352 000001D4 E59F0268        LDR              R0, =PIT_BASE
  353 000001D8         
  354 000001D8         ; Интервал перезагрузки таймера: 0x010000 (65536)
  355 000001D8         ; Итого частота возникновения прерывания равна: 
  356 000001D8         ; 95.8464 МГц/65536 = 1.762 кГц
  357 000001D8 E3A02001        MOV              R2, #1
  358 000001DC E1A02802        LSL              R2, #16
  359 000001E0 E1822001        ORR              R2, R1
  360 000001E4 E5802000        STR              R2, [R0, #PIT_MR]
  361 000001E8         
  362 000001E8         
  363 000001E8         ; Бесконечный цикл - просто мигаем подсветкой LCD и выво
                       дим сообщение
  364 000001E8         FOREVER
  365 000001E8         
  366 000001E8         ; Включение подсветки LCD
  367 000001E8 E59F0244        LDR              R0, =PIOB_BASE
  368 000001EC E3A01001        MOV              R1, #1
  369 000001F0 E1A01A01        LSL              R1, #20



ARM Macro Assembler    Page 18 


  370 000001F4 E5801030        STR              R1, [R0, #PIO_SODR]
  371 000001F8         
  372 000001F8 EBFFFFFE        BL               BLINKDELAY
  373 000001FC         
  374 000001FC         ; Выключение подсветки LCD
  375 000001FC E59F0230        LDR              R0, =PIOB_BASE
  376 00000200 E3A01001        MOV              R1, #1
  377 00000204 E1A01A01        LSL              R1, #20
  378 00000208 E5801034        STR              R1, [R0, #PIO_CODR]
  379 0000020C         
  380 0000020C E59F0234        LDR              R0, =Msg
  381 00000210 EBFFFFFE        BL               UART_SEND_STR
  382 00000214 EBFFFFFE        BL               BLINKDELAY
  383 00000218 EAFFFFF2        B                FOREVER
  384 0000021C         
  385 0000021C         Task1_Proc
                               PROC
  386 0000021C E52DE004        PUSH             {LR}
  387 00000220 E52D0004        PUSH             {R0}
  388 00000224 E52D1004        PUSH             {R1}
  389 00000228         
  390 00000228 EBFFFFFE        BL               DisablePIT
  391 0000022C         
  392 0000022C         ; Output state to UART
  393 0000022C E59F0218        LDR              R0, =Task1Msg
  394 00000230 EBFFFFFE        BL               UART_SEND_STR
  395 00000234         
  396 00000234 E3A02020        MOV              R2, #' '
  397 00000238 EBFFFFFE        BL               UART_SEND_CHR
  398 0000023C         
  399 0000023C E59F020C        LDR              R0, =CommonCntrMsg
  400 00000240 EBFFFFFE        BL               UART_SEND_STR
  401 00000244         
  402 00000244 E59F0208        LDR              R0, =CommonCounter
  403 00000248 E5901000        LDR              R1, [R0]
  404 0000024C E1A02001        MOV              R2, R1
  405 00000250 EBFFFFFE        BL               WRITE_BYTE_HEX
  406 00000254         
  407 00000254 E3A02020        MOV              R2, #' '
  408 00000258 EBFFFFFE        BL               UART_SEND_CHR
  409 0000025C         
  410 0000025C E59F01F4        LDR              R0, =TaskCntrMsg
  411 00000260 EBFFFFFE        BL               UART_SEND_STR
  412 00000264         
  413 00000264 E59F01F0        LDR              R0, =Task1Counter
  414 00000268 E5901000        LDR              R1, [R0]
  415 0000026C E1A02001        MOV              R2, R1
  416 00000270 EBFFFFFE        BL               WRITE_BYTE_HEX
  417 00000274         
  418 00000274 E59F01E4        LDR              R0, =CRLF
  419 00000278 EBFFFFFE        BL               UART_SEND_STR
  420 0000027C         
  421 0000027C         ; Increment counters
  422 0000027C E59F01D0        LDR              R0, =CommonCounter
  423 00000280 E5901000        LDR              R1, [R0]
  424 00000284 E2811001        ADD              R1, #1
  425 00000288 E5801000        STR              R1, [R0]
  426 0000028C         
  427 0000028C E59F01C8        LDR              R0, =Task1Counter



ARM Macro Assembler    Page 19 


  428 00000290 E5901000        LDR              R1, [R0]
  429 00000294 E2811001        ADD              R1, #1
  430 00000298 E5801000        STR              R1, [R0]
  431 0000029C         
  432 0000029C EBFFFFFE        BL               EnablePIT
  433 000002A0         
  434 000002A0 E49D1004        POP              {R1}
  435 000002A4 E49D0004        POP              {R0}
  436 000002A8 E49DF004        POP              {PC}
  437 000002AC                 ENDP
  438 000002AC         
  439 000002AC         Task2_Proc
                               PROC
  440 000002AC         
  441 000002AC E52DE004        PUSH             {LR}
  442 000002B0 E52D0004        PUSH             {R0}
  443 000002B4 E52D1004        PUSH             {R1}
  444 000002B8         
  445 000002B8 EBFFFFFE        BL               DisablePIT
  446 000002BC         
  447 000002BC         ; Output state to UART
  448 000002BC E59F01A0        LDR              R0, =Task2Msg
  449 000002C0 EBFFFFFE        BL               UART_SEND_STR
  450 000002C4         
  451 000002C4 E3A02020        MOV              R2, #' '
  452 000002C8 EBFFFFFE        BL               UART_SEND_CHR
  453 000002CC         
  454 000002CC E59F017C        LDR              R0, =CommonCntrMsg
  455 000002D0 EBFFFFFE        BL               UART_SEND_STR
  456 000002D4         
  457 000002D4 E59F0178        LDR              R0, =CommonCounter
  458 000002D8 E5901000        LDR              R1, [R0]
  459 000002DC E1A02001        MOV              R2, R1
  460 000002E0 EBFFFFFE        BL               WRITE_BYTE_HEX
  461 000002E4         
  462 000002E4 E3A02020        MOV              R2, #' '
  463 000002E8 EBFFFFFE        BL               UART_SEND_CHR
  464 000002EC         
  465 000002EC E59F0164        LDR              R0, =TaskCntrMsg
  466 000002F0 EBFFFFFE        BL               UART_SEND_STR
  467 000002F4         
  468 000002F4 E59F016C        LDR              R0, =Task2Counter
  469 000002F8 E5901000        LDR              R1, [R0]
  470 000002FC E1A02001        MOV              R2, R1
  471 00000300 EBFFFFFE        BL               WRITE_BYTE_HEX
  472 00000304         
  473 00000304 E59F0154        LDR              R0, =CRLF
  474 00000308 EBFFFFFE        BL               UART_SEND_STR
  475 0000030C         
  476 0000030C         ; Increment counters
  477 0000030C E59F0140        LDR              R0, =CommonCounter
  478 00000310 E5901000        LDR              R1, [R0]
  479 00000314 E2811001        ADD              R1, #1
  480 00000318 E5801000        STR              R1, [R0]
  481 0000031C         
  482 0000031C E59F0144        LDR              R0, =Task2Counter
  483 00000320 E5901000        LDR              R1, [R0]
  484 00000324 E2811001        ADD              R1, #1
  485 00000328 E5801000        STR              R1, [R0]



ARM Macro Assembler    Page 20 


  486 0000032C EBFFFFFE        BL               EnablePIT
  487 00000330         
  488 00000330 E49D1004        POP              {R1}
  489 00000334 E49D0004        POP              {R0}
  490 00000338 E49DF004        POP              {PC}
  491 0000033C         
  492 0000033C                 ENDP
  493 0000033C         
  494 0000033C         Task3_Proc
                               PROC
  495 0000033C         
  496 0000033C E52DE004        PUSH             {LR}
  497 00000340 E52D0004        PUSH             {R0}
  498 00000344 E52D1004        PUSH             {R1}
  499 00000348         
  500 00000348 EBFFFFFE        BL               DisablePIT
  501 0000034C         
  502 0000034C         ; Output state to UART
  503 0000034C E59F0118        LDR              R0, =Task3Msg
  504 00000350 EBFFFFFE        BL               UART_SEND_STR
  505 00000354         
  506 00000354 E3A02020        MOV              R2, #' '
  507 00000358 EBFFFFFE        BL               UART_SEND_CHR
  508 0000035C         
  509 0000035C E59F00EC        LDR              R0, =CommonCntrMsg
  510 00000360 EBFFFFFE        BL               UART_SEND_STR
  511 00000364         
  512 00000364 E59F00E8        LDR              R0, =CommonCounter
  513 00000368 E5901000        LDR              R1, [R0]
  514 0000036C E1A02001        MOV              R2, R1
  515 00000370 EBFFFFFE        BL               WRITE_BYTE_HEX
  516 00000374         
  517 00000374 E3A02020        MOV              R2, #' '
  518 00000378 EBFFFFFE        BL               UART_SEND_CHR
  519 0000037C         
  520 0000037C E59F00D4        LDR              R0, =TaskCntrMsg
  521 00000380 EBFFFFFE        BL               UART_SEND_STR
  522 00000384         
  523 00000384 E59F00E4        LDR              R0, =Task3Counter
  524 00000388 E5901000        LDR              R1, [R0]
  525 0000038C E1A02001        MOV              R2, R1
  526 00000390 EBFFFFFE        BL               WRITE_BYTE_HEX
  527 00000394         
  528 00000394 E59F00C4        LDR              R0, =CRLF
  529 00000398 EBFFFFFE        BL               UART_SEND_STR
  530 0000039C         
  531 0000039C         ; Increment counters
  532 0000039C E59F00B0        LDR              R0, =CommonCounter
  533 000003A0 E5901000        LDR              R1, [R0]
  534 000003A4 E2811001        ADD              R1, #1
  535 000003A8 E5801000        STR              R1, [R0]
  536 000003AC         
  537 000003AC E59F00BC        LDR              R0, =Task3Counter
  538 000003B0 E5901000        LDR              R1, [R0]
  539 000003B4 E2811001        ADD              R1, #1
  540 000003B8 E5801000        STR              R1, [R0]
  541 000003BC         
  542 000003BC EBFFFFFE        BL               EnablePIT
  543 000003C0         



ARM Macro Assembler    Page 21 


  544 000003C0 E49D1004        POP              {R1}
  545 000003C4 E49D0004        POP              {R0}
  546 000003C8 E49DF004        POP              {PC}
  547 000003CC                 ENDP
  548 000003CC         
  549 000003CC         Timer_IRQ
  550 000003CC         
  551 000003CC         ; Save Current state to stack
  552 000003CC         
  553 000003CC E24EE004        SUB              LR, LR, #4
  554 000003D0 E92D5FFF        STMFD            SP!, {R0-R12, LR}
  555 000003D4         
  556 000003D4         ; Print and update next task number
  557 000003D4 E59F0098        LDR              R0, =NextTaskNumber
  558 000003D8 E5901000        LDR              R1, [R0]
  559 000003DC E3510003        CMP              R1, #3
  560 000003E0 03A01000        MOVEQ            R1, #0
  561 000003E4 E2811001        ADD              R1, #1
  562 000003E8 E5801000        STR              R1, [R0]
  563 000003EC         
  564 000003EC E3510001        CMP              R1, #1
  565 000003F0 0BFFFFFE        BLEQ             Task1_Proc
  566 000003F4 E3510002        CMP              R1, #2
  567 000003F8 0BFFFFFE        BLEQ             Task2_Proc
  568 000003FC E3510003        CMP              R1, #3
  569 00000400 0BFFFFFE        BLEQ             Task3_Proc
  570 00000404         
  571 00000404         ; Dummy read PIT to clear it's IRQ
  572 00000404 E59F0038        LDR              R0, =PIT_BASE
  573 00000408 E5901008        LDR              R1, [R0, #PIT_PIVR]
  574 0000040C         
  575 0000040C         ; Clear interrupt in AIC
  576 0000040C E59F0028        LDR              R0, =AIC_BASE
  577 00000410 E3A01002        MOV              R1, #0x02
  578 00000414 E5801128        STR              R1, [R0, #AIC_ICCR]
  579 00000418 E5801130        STR              R1, [R0, #AIC_EOICR]
  580 0000041C         
  581 0000041C         ; Restore state from stack and set User mode
  582 0000041C E8FD9FFF        LDMFD            SP!,{R0-R12, PC}^
  583 00000420         
  584 00000420                 END
              FFFFFC00 
              00000601 
              00191C05 
              00000000 
              FFFFF400 
              FFFFF600 
              FFFC0000 
              FFFFF000 
              00000000 
              FFFFFD30 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 22 


              00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --apcs=interwork --depend=.\o
bjects\sam7.d -o.\objects\sam7.o -ID:\Keil_v5\ARM\RV31\INC -ID:\Keil_v5\ARM\CMS
IS\Include -ID:\Keil_v5\ARM\INC\Atmel\SAM7X --predefine="__UVISION_VERSION SETA
 524" --list=.\listings\sam7.lst SAM7.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

BLINKDELAY 00000000

Symbol: BLINKDELAY
   Definitions
      At line 4 in file util.s
   Uses
      At line 372 in file SAM7.s
      At line 382 in file SAM7.s

DELAY_1 00000014

Symbol: DELAY_1
   Definitions
      At line 12 in file util.s
   Uses
      At line 23 in file util.s
Comment: DELAY_1 used once
DELAY_2 0000001C

Symbol: DELAY_2
   Definitions
      At line 17 in file util.s
   Uses
      At line 20 in file util.s
Comment: DELAY_2 used once
DisablePIT 00000134

Symbol: DisablePIT
   Definitions
      At line 130 in file util.s
   Uses
      At line 390 in file SAM7.s
      At line 445 in file SAM7.s
      At line 500 in file SAM7.s

EnablePIT 0000016C

Symbol: EnablePIT
   Definitions
      At line 155 in file util.s
   Uses
      At line 432 in file SAM7.s
      At line 486 in file SAM7.s
      At line 542 in file SAM7.s

GREATER_THAN9 000000E4

Symbol: GREATER_THAN9
   Definitions
      At line 103 in file util.s
   Uses
      At line 96 in file util.s
Comment: GREATER_THAN9 used once
NEXT_CHR 00000098

Symbol: NEXT_CHR
   Definitions
      At line 74 in file util.s
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 80 in file util.s
Comment: NEXT_CHR used once
STR_END 000000B0

Symbol: STR_END
   Definitions
      At line 81 in file util.s
   Uses
      At line 77 in file util.s
Comment: STR_END used once
UART_SEND_CHR 0000003C

Symbol: UART_SEND_CHR
   Definitions
      At line 33 in file util.s
   Uses
      At line 78 in file util.s
      At line 98 in file util.s
      At line 105 in file util.s
      At line 397 in file SAM7.s
      At line 408 in file SAM7.s
      At line 452 in file SAM7.s
      At line 463 in file SAM7.s
      At line 507 in file SAM7.s
      At line 518 in file SAM7.s

UART_SEND_STR 00000088

Symbol: UART_SEND_STR
   Definitions
      At line 66 in file util.s
   Uses
      At line 381 in file SAM7.s
      At line 394 in file SAM7.s
      At line 400 in file SAM7.s
      At line 411 in file SAM7.s
      At line 419 in file SAM7.s
      At line 449 in file SAM7.s
      At line 455 in file SAM7.s
      At line 466 in file SAM7.s
      At line 474 in file SAM7.s
      At line 504 in file SAM7.s
      At line 510 in file SAM7.s
      At line 521 in file SAM7.s
      At line 529 in file SAM7.s

Util 00000000

Symbol: Util
   Definitions
      At line 2 in file util.s
   Uses
      None
Comment: Util unused
WAIT_SENT 00000058

Symbol: WAIT_SENT
   Definitions
      At line 46 in file util.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 54 in file util.s
Comment: WAIT_SENT used once
WRITE_BYTE_HEX 000000F4

Symbol: WRITE_BYTE_HEX
   Definitions
      At line 110 in file util.s
   Uses
      At line 405 in file SAM7.s
      At line 416 in file SAM7.s
      At line 460 in file SAM7.s
      At line 471 in file SAM7.s
      At line 515 in file SAM7.s
      At line 526 in file SAM7.s

WRITE_DIGIT_HEX 000000C0

Symbol: WRITE_DIGIT_HEX
   Definitions
      At line 90 in file util.s
   Uses
      At line 120 in file util.s
      At line 124 in file util.s

14 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

STACK 00000000

Symbol: STACK
   Definitions
      At line 28 in file SAM7.s
   Uses
      None
Comment: STACK unused
Stack_Mem 00000000

Symbol: Stack_Mem
   Definitions
      At line 30 in file SAM7.s
   Uses
      None
Comment: Stack_Mem unused
Stack_Top 00000488

Symbol: Stack_Top
   Definitions
      At line 32 in file SAM7.s
   Uses
      At line 217 in file SAM7.s
Comment: Stack_Top used once
Task1_Stack_Mem 00000488

Symbol: Task1_Stack_Mem
   Definitions
      At line 34 in file SAM7.s
   Uses
      None
Comment: Task1_Stack_Mem unused
Task1_Stack_Top 00000588

Symbol: Task1_Stack_Top
   Definitions
      At line 35 in file SAM7.s
   Uses
      None
Comment: Task1_Stack_Top unused
Task2_Stack_Mem 00000588

Symbol: Task2_Stack_Mem
   Definitions
      At line 37 in file SAM7.s
   Uses
      None
Comment: Task2_Stack_Mem unused
Task2_Stack_Top 00000688

Symbol: Task2_Stack_Top
   Definitions
      At line 38 in file SAM7.s
   Uses
      None
Comment: Task2_Stack_Top unused
Task3_Stack_Mem 00000688

Symbol: Task3_Stack_Mem



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 40 in file SAM7.s
   Uses
      None
Comment: Task3_Stack_Mem unused
Task3_Stack_Top 00000788

Symbol: Task3_Stack_Top
   Definitions
      At line 41 in file SAM7.s
   Uses
      None
Comment: Task3_Stack_Top unused
__initial_sp 00000400

Symbol: __initial_sp
   Definitions
      At line 31 in file SAM7.s
   Uses
      None
Comment: __initial_sp unused
10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

HEAP 00000000

Symbol: HEAP
   Definitions
      At line 44 in file SAM7.s
   Uses
      None
Comment: HEAP unused
Heap_Mem 00000000

Symbol: Heap_Mem
   Definitions
      At line 46 in file SAM7.s
   Uses
      None
Comment: Heap_Mem unused
__heap_base 00000000

Symbol: __heap_base
   Definitions
      At line 45 in file SAM7.s
   Uses
      None
Comment: __heap_base unused
__heap_limit 00000000

Symbol: __heap_limit
   Definitions
      At line 47 in file SAM7.s
   Uses
      None
Comment: __heap_limit unused
4 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CRLF 0000002B

Symbol: CRLF
   Definitions
      At line 57 in file SAM7.s
   Uses
      At line 418 in file SAM7.s
      At line 473 in file SAM7.s
      At line 528 in file SAM7.s

CommonCntrMsg 00000059

Symbol: CommonCntrMsg
   Definitions
      At line 63 in file SAM7.s
   Uses
      At line 399 in file SAM7.s
      At line 454 in file SAM7.s
      At line 509 in file SAM7.s

DATA 00000000

Symbol: DATA
   Definitions
      At line 53 in file SAM7.s
   Uses
      None
Comment: DATA unused
IRQMsg 0000001A

Symbol: IRQMsg
   Definitions
      At line 56 in file SAM7.s
   Uses
      None
Comment: IRQMsg unused
Msg 00000000

Symbol: Msg
   Definitions
      At line 55 in file SAM7.s
   Uses
      At line 380 in file SAM7.s
Comment: Msg used once
ShedMsg 0000006F

Symbol: ShedMsg
   Definitions
      At line 65 in file SAM7.s
   Uses
      None
Comment: ShedMsg unused
Task1Msg 0000002E

Symbol: Task1Msg
   Definitions
      At line 59 in file SAM7.s
   Uses
      At line 393 in file SAM7.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Comment: Task1Msg used once
Task2Msg 00000036

Symbol: Task2Msg
   Definitions
      At line 60 in file SAM7.s
   Uses
      At line 448 in file SAM7.s
Comment: Task2Msg used once
Task3Msg 0000003E

Symbol: Task3Msg
   Definitions
      At line 61 in file SAM7.s
   Uses
      At line 503 in file SAM7.s
Comment: Task3Msg used once
TaskCntrMsg 00000046

Symbol: TaskCntrMsg
   Definitions
      At line 62 in file SAM7.s
   Uses
      At line 410 in file SAM7.s
      At line 465 in file SAM7.s
      At line 520 in file SAM7.s

10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CommonCounter 00000000

Symbol: CommonCounter
   Definitions
      At line 69 in file SAM7.s
   Uses
      At line 402 in file SAM7.s
      At line 422 in file SAM7.s
      At line 457 in file SAM7.s
      At line 477 in file SAM7.s
      At line 512 in file SAM7.s
      At line 532 in file SAM7.s

NextTaskNumber 00000020

Symbol: NextTaskNumber
   Definitions
      At line 73 in file SAM7.s
   Uses
      At line 557 in file SAM7.s
Comment: NextTaskNumber used once
SystemSP 00000040

Symbol: SystemSP
   Definitions
      At line 81 in file SAM7.s
   Uses
      None
Comment: SystemSP unused
Task1Counter 00000008

Symbol: Task1Counter
   Definitions
      At line 70 in file SAM7.s
   Uses
      At line 413 in file SAM7.s
      At line 427 in file SAM7.s

Task1SP 00000028

Symbol: Task1SP
   Definitions
      At line 78 in file SAM7.s
   Uses
      None
Comment: Task1SP unused
Task2Counter 00000010

Symbol: Task2Counter
   Definitions
      At line 71 in file SAM7.s
   Uses
      At line 468 in file SAM7.s
      At line 482 in file SAM7.s

Task2SP 00000030

Symbol: Task2SP
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 79 in file SAM7.s
   Uses
      None
Comment: Task2SP unused
Task3Counter 00000018

Symbol: Task3Counter
   Definitions
      At line 72 in file SAM7.s
   Uses
      At line 523 in file SAM7.s
      At line 537 in file SAM7.s

Task3SP 00000038

Symbol: Task3SP
   Definitions
      At line 80 in file SAM7.s
   Uses
      None
Comment: Task3SP unused
Var 00000000

Symbol: Var
   Definitions
      At line 68 in file SAM7.s
   Uses
      None
Comment: Var unused
10 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

DAbt_Addr 00000030

Symbol: DAbt_Addr
   Definitions
      At line 112 in file SAM7.s
   Uses
      At line 101 in file SAM7.s
Comment: DAbt_Addr used once
DAbt_Handler 0000004C

Symbol: DAbt_Handler
   Definitions
      At line 120 in file SAM7.s
   Uses
      At line 112 in file SAM7.s
      At line 120 in file SAM7.s

ENTRYPOINT 000000FC

Symbol: ENTRYPOINT
   Definitions
      At line 260 in file SAM7.s
   Uses
      None
Comment: ENTRYPOINT unused
FIQ_Addr 0000003C

Symbol: FIQ_Addr
   Definitions
      At line 115 in file SAM7.s
   Uses
      None
Comment: FIQ_Addr unused
FIQ_Handler 00000054

Symbol: FIQ_Handler
   Definitions
      At line 127 in file SAM7.s
   Uses
      At line 115 in file SAM7.s
      At line 127 in file SAM7.s

FOREVER 000001E8

Symbol: FOREVER
   Definitions
      At line 364 in file SAM7.s
   Uses
      At line 383 in file SAM7.s
Comment: FOREVER used once
IRQ_Addr 00000038

Symbol: IRQ_Addr
   Definitions
      At line 114 in file SAM7.s
   Uses
      None
Comment: IRQ_Addr unused
IRQ_Handler 00000050



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols


Symbol: IRQ_Handler
   Definitions
      At line 123 in file SAM7.s
   Uses
      At line 114 in file SAM7.s
      At line 335 in file SAM7.s

MOSCS_Loop 00000064

Symbol: MOSCS_Loop
   Definitions
      At line 146 in file SAM7.s
   Uses
      At line 148 in file SAM7.s
Comment: MOSCS_Loop used once
PAbt_Addr 0000002C

Symbol: PAbt_Addr
   Definitions
      At line 111 in file SAM7.s
   Uses
      At line 100 in file SAM7.s
Comment: PAbt_Addr used once
PAbt_Handler 00000048

Symbol: PAbt_Handler
   Definitions
      At line 119 in file SAM7.s
   Uses
      At line 111 in file SAM7.s
      At line 119 in file SAM7.s

PLL_Loop 00000078

Symbol: PLL_Loop
   Definitions
      At line 157 in file SAM7.s
   Uses
      At line 159 in file SAM7.s
Comment: PLL_Loop used once
RESET 00000000

Symbol: RESET
   Definitions
      At line 88 in file SAM7.s
   Uses
      None
Comment: RESET unused
Reset_Addr 00000020

Symbol: Reset_Addr
   Definitions
      At line 108 in file SAM7.s
   Uses
      At line 97 in file SAM7.s
Comment: Reset_Addr used once
Reset_Handler 00000058




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

Symbol: Reset_Handler
   Definitions
      At line 133 in file SAM7.s
   Uses
      At line 108 in file SAM7.s
      At line 132 in file SAM7.s

SWI_Addr 00000028

Symbol: SWI_Addr
   Definitions
      At line 110 in file SAM7.s
   Uses
      At line 99 in file SAM7.s
Comment: SWI_Addr used once
SWI_Handler 00000044

Symbol: SWI_Handler
   Definitions
      At line 118 in file SAM7.s
   Uses
      At line 110 in file SAM7.s
      At line 118 in file SAM7.s

Task1_Proc 0000021C

Symbol: Task1_Proc
   Definitions
      At line 385 in file SAM7.s
   Uses
      At line 565 in file SAM7.s
Comment: Task1_Proc used once
Task2_Proc 000002AC

Symbol: Task2_Proc
   Definitions
      At line 439 in file SAM7.s
   Uses
      At line 567 in file SAM7.s
Comment: Task2_Proc used once
Task3_Proc 0000033C

Symbol: Task3_Proc
   Definitions
      At line 494 in file SAM7.s
   Uses
      At line 569 in file SAM7.s
Comment: Task3_Proc used once
Timer_IRQ 000003CC

Symbol: Timer_IRQ
   Definitions
      At line 549 in file SAM7.s
   Uses
      At line 124 in file SAM7.s
Comment: Timer_IRQ used once
Undef_Addr 00000024

Symbol: Undef_Addr



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 109 in file SAM7.s
   Uses
      At line 98 in file SAM7.s
Comment: Undef_Addr used once
Undef_Handler 00000040

Symbol: Undef_Handler
   Definitions
      At line 117 in file SAM7.s
   Uses
      At line 109 in file SAM7.s
      At line 117 in file SAM7.s

Vectors 00000000

Symbol: Vectors
   Definitions
      At line 97 in file SAM7.s
   Uses
      None
Comment: Vectors unused
WAIT_Rdy1 00000090

Symbol: WAIT_Rdy1
   Definitions
      At line 179 in file SAM7.s
   Uses
      At line 181 in file SAM7.s
Comment: WAIT_Rdy1 used once
WAIT_Rdy2 000000A4

Symbol: WAIT_Rdy2
   Definitions
      At line 184 in file SAM7.s
   Uses
      At line 186 in file SAM7.s
Comment: WAIT_Rdy2 used once
26 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

ABT_Stack_Size 00000000

Symbol: ABT_Stack_Size
   Definitions
      At line 20 in file defines.s
   Uses
      At line 26 in file defines.s
      At line 227 in file SAM7.s

AIC_BASE FFFFF000

Symbol: AIC_BASE
   Definitions
      At line 129 in file defines.s
   Uses
      At line 334 in file SAM7.s
      At line 340 in file SAM7.s
      At line 576 in file SAM7.s

AIC_EOICR 00000130

Symbol: AIC_EOICR
   Definitions
      At line 135 in file defines.s
   Uses
      At line 579 in file SAM7.s
Comment: AIC_EOICR used once
AIC_ICCR 00000128

Symbol: AIC_ICCR
   Definitions
      At line 134 in file defines.s
   Uses
      At line 578 in file SAM7.s
Comment: AIC_ICCR used once
AIC_IECR 00000120

Symbol: AIC_IECR
   Definitions
      At line 133 in file defines.s
   Uses
      At line 347 in file SAM7.s
Comment: AIC_IECR used once
AIC_IMR 00000110

Symbol: AIC_IMR
   Definitions
      At line 132 in file defines.s
   Uses
      None
Comment: AIC_IMR unused
AIC_SMR1 00000004

Symbol: AIC_SMR1
   Definitions
      At line 130 in file defines.s
   Uses
      At line 343 in file SAM7.s
Comment: AIC_SMR1 used once



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

AIC_SVR1 00000084

Symbol: AIC_SVR1
   Definitions
      At line 131 in file defines.s
   Uses
      At line 336 in file SAM7.s
Comment: AIC_SVR1 used once
DBGU_BASE FFFFF200

Symbol: DBGU_BASE
   Definitions
      At line 89 in file defines.s
   Uses
      None
Comment: DBGU_BASE unused
DBGU_BRGR 00000020

Symbol: DBGU_BRGR
   Definitions
      At line 110 in file defines.s
   Uses
      None
Comment: DBGU_BRGR unused
DBGU_CR 00000000

Symbol: DBGU_CR
   Definitions
      At line 105 in file defines.s
   Uses
      None
Comment: DBGU_CR unused
DBGU_CSR 00000014

Symbol: DBGU_CSR
   Definitions
      At line 107 in file defines.s
   Uses
      None
Comment: DBGU_CSR unused
DBGU_IDR 0000000C

Symbol: DBGU_IDR
   Definitions
      At line 109 in file defines.s
   Uses
      None
Comment: DBGU_IDR unused
DBGU_MR 00000004

Symbol: DBGU_MR
   Definitions
      At line 106 in file defines.s
   Uses
      None
Comment: DBGU_MR unused
DBGU_PDC_BASE FFFFF300

Symbol: DBGU_PDC_BASE



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 114 in file defines.s
   Uses
      None
Comment: DBGU_PDC_BASE unused
DBGU_PDC_PTCR 00000020

Symbol: DBGU_PDC_PTCR
   Definitions
      At line 115 in file defines.s
   Uses
      None
Comment: DBGU_PDC_PTCR unused
DBGU_THR 0000001C

Symbol: DBGU_THR
   Definitions
      At line 108 in file defines.s
   Uses
      None
Comment: DBGU_THR unused
EFC0_FMR 00000060

Symbol: EFC0_FMR
   Definitions
      At line 43 in file defines.s
   Uses
      None
Comment: EFC0_FMR unused
EFC0_FMR_Val 00320100

Symbol: EFC0_FMR_Val
   Definitions
      At line 47 in file defines.s
   Uses
      None
Comment: EFC0_FMR_Val unused
EFC0_SETUP 00000001

Symbol: EFC0_SETUP
   Definitions
      At line 46 in file defines.s
   Uses
      None
Comment: EFC0_SETUP unused
EFC1_FMR 00000070

Symbol: EFC1_FMR
   Definitions
      At line 44 in file defines.s
   Uses
      None
Comment: EFC1_FMR unused
EFC1_FMR_Val 00320100

Symbol: EFC1_FMR_Val
   Definitions
      At line 50 in file defines.s
   Uses



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols

      None
Comment: EFC1_FMR_Val unused
EFC1_SETUP 00000000

Symbol: EFC1_SETUP
   Definitions
      At line 49 in file defines.s
   Uses
      None
Comment: EFC1_SETUP unused
EFC_BASE FFFFFF00

Symbol: EFC_BASE
   Definitions
      At line 42 in file defines.s
   Uses
      None
Comment: EFC_BASE unused
FIQ_Stack_Size 00000000

Symbol: FIQ_Stack_Size
   Definitions
      At line 21 in file defines.s
   Uses
      At line 26 in file defines.s
      At line 232 in file SAM7.s

FLASH_BASE 00100000

Symbol: FLASH_BASE
   Definitions
      At line 15 in file defines.s
   Uses
      None
Comment: FLASH_BASE unused
F_Bit 00000040

Symbol: F_Bit
   Definitions
      At line 12 in file defines.s
   Uses
      At line 220 in file SAM7.s
      At line 225 in file SAM7.s
      At line 230 in file SAM7.s
      At line 235 in file SAM7.s
      At line 240 in file SAM7.s

Heap_Size 00000000

Symbol: Heap_Size
   Definitions
      At line 28 in file defines.s
   Uses
      At line 46 in file SAM7.s
Comment: Heap_Size used once
IRQ_Stack_Size 00000080

Symbol: IRQ_Stack_Size
   Definitions



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

      At line 22 in file defines.s
   Uses
      At line 26 in file defines.s
      At line 237 in file SAM7.s

ISR_Stack_Size 00000088

Symbol: ISR_Stack_Size
   Definitions
      At line 26 in file defines.s
   Uses
      At line 31 in file SAM7.s
Comment: ISR_Stack_Size used once
I_Bit 00000080

Symbol: I_Bit
   Definitions
      At line 11 in file defines.s
   Uses
      At line 220 in file SAM7.s
      At line 225 in file SAM7.s
      At line 230 in file SAM7.s
      At line 235 in file SAM7.s
      At line 240 in file SAM7.s

MC_BASE FFFFFF00

Symbol: MC_BASE
   Definitions
      At line 205 in file SAM7.s
   Uses
      None
Comment: MC_BASE unused
MC_RCR 00000000

Symbol: MC_RCR
   Definitions
      At line 206 in file SAM7.s
   Uses
      None
Comment: MC_RCR unused
Mode_ABT 00000017

Symbol: Mode_ABT
   Definitions
      At line 7 in file defines.s
   Uses
      At line 225 in file SAM7.s
Comment: Mode_ABT used once
Mode_FIQ 00000011

Symbol: Mode_FIQ
   Definitions
      At line 4 in file defines.s
   Uses
      At line 230 in file SAM7.s
Comment: Mode_FIQ used once
Mode_IRQ 00000012




ARM Macro Assembler    Page 6 Alphabetic symbol ordering
Absolute symbols

Symbol: Mode_IRQ
   Definitions
      At line 5 in file defines.s
   Uses
      At line 235 in file SAM7.s
Comment: Mode_IRQ used once
Mode_SVC 00000013

Symbol: Mode_SVC
   Definitions
      At line 6 in file defines.s
   Uses
      At line 240 in file SAM7.s
Comment: Mode_SVC used once
Mode_SYS 0000001F

Symbol: Mode_SYS
   Definitions
      At line 9 in file defines.s
   Uses
      None
Comment: Mode_SYS unused
Mode_UND 0000001B

Symbol: Mode_UND
   Definitions
      At line 8 in file defines.s
   Uses
      At line 220 in file SAM7.s
Comment: Mode_UND used once
Mode_USR 00000010

Symbol: Mode_USR
   Definitions
      At line 3 in file defines.s
   Uses
      At line 245 in file SAM7.s
Comment: Mode_USR used once
PIOA_BASE FFFFF400

Symbol: PIOA_BASE
   Definitions
      At line 87 in file defines.s
   Uses
      At line 275 in file SAM7.s
Comment: PIOA_BASE used once
PIOB_BASE FFFFF600

Symbol: PIOB_BASE
   Definitions
      At line 88 in file defines.s
   Uses
      At line 284 in file SAM7.s
      At line 367 in file SAM7.s
      At line 375 in file SAM7.s

PIO_ASR 00000070

Symbol: PIO_ASR



ARM Macro Assembler    Page 7 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 100 in file defines.s
   Uses
      At line 277 in file SAM7.s
Comment: PIO_ASR used once
PIO_BSR 00000074

Symbol: PIO_BSR
   Definitions
      At line 101 in file defines.s
   Uses
      None
Comment: PIO_BSR unused
PIO_CODR 00000034

Symbol: PIO_CODR
   Definitions
      At line 99 in file defines.s
   Uses
      At line 281 in file SAM7.s
      At line 378 in file SAM7.s

PIO_IFDR 00000024

Symbol: PIO_IFDR
   Definitions
      At line 97 in file defines.s
   Uses
      At line 280 in file SAM7.s
Comment: PIO_IFDR used once
PIO_ODR 00000014

Symbol: PIO_ODR
   Definitions
      At line 96 in file defines.s
   Uses
      At line 279 in file SAM7.s
Comment: PIO_ODR used once
PIO_OER 00000010

Symbol: PIO_OER
   Definitions
      At line 95 in file defines.s
   Uses
      At line 287 in file SAM7.s
Comment: PIO_OER used once
PIO_PDR 00000004

Symbol: PIO_PDR
   Definitions
      At line 94 in file defines.s
   Uses
      At line 278 in file SAM7.s
Comment: PIO_PDR used once
PIO_SODR 00000030

Symbol: PIO_SODR
   Definitions
      At line 98 in file defines.s



ARM Macro Assembler    Page 8 Alphabetic symbol ordering
Absolute symbols

   Uses
      At line 370 in file SAM7.s
Comment: PIO_SODR used once
PIT_BASE FFFFFD30

Symbol: PIT_BASE
   Definitions
      At line 138 in file defines.s
   Uses
      At line 138 in file util.s
      At line 163 in file util.s
      At line 352 in file SAM7.s
      At line 572 in file SAM7.s

PIT_MR 00000000

Symbol: PIT_MR
   Definitions
      At line 139 in file defines.s
   Uses
      At line 144 in file util.s
      At line 146 in file util.s
      At line 169 in file util.s
      At line 171 in file util.s
      At line 360 in file SAM7.s

PIT_PIIR 0000000C

Symbol: PIT_PIIR
   Definitions
      At line 142 in file defines.s
   Uses
      None
Comment: PIT_PIIR unused
PIT_PIVR 00000008

Symbol: PIT_PIVR
   Definitions
      At line 141 in file defines.s
   Uses
      At line 573 in file SAM7.s
Comment: PIT_PIVR used once
PIT_SR 00000004

Symbol: PIT_SR
   Definitions
      At line 140 in file defines.s
   Uses
      None
Comment: PIT_SR unused
PMC_BASE FFFFFC00

Symbol: PMC_BASE
   Definitions
      At line 60 in file defines.s
   Uses
      At line 138 in file SAM7.s
      At line 263 in file SAM7.s
      At line 269 in file SAM7.s



ARM Macro Assembler    Page 9 Alphabetic symbol ordering
Absolute symbols

      At line 290 in file SAM7.s

PMC_CSS 00000003

Symbol: PMC_CSS
   Definitions
      At line 75 in file defines.s
   Uses
      At line 163 in file SAM7.s
      At line 175 in file SAM7.s

PMC_DIV 000000FF

Symbol: PMC_DIV
   Definitions
      At line 70 in file defines.s
   Uses
      None
Comment: PMC_DIV unused
PMC_LOCK 00000004

Symbol: PMC_LOCK
   Definitions
      At line 78 in file defines.s
   Uses
      At line 158 in file SAM7.s
Comment: PMC_LOCK used once
PMC_MCFR 00000024

Symbol: PMC_MCFR
   Definitions
      At line 63 in file defines.s
   Uses
      None
Comment: PMC_MCFR unused
PMC_MCKR 00000030

Symbol: PMC_MCKR
   Definitions
      At line 65 in file defines.s
   Uses
      At line 178 in file SAM7.s
      At line 183 in file SAM7.s

PMC_MCKRDY 00000008

Symbol: PMC_MCKRDY
   Definitions
      At line 79 in file defines.s
   Uses
      At line 180 in file SAM7.s
      At line 185 in file SAM7.s

PMC_MCKR_Val 00000007

Symbol: PMC_MCKR_Val
   Definitions
      At line 83 in file defines.s
   Uses



ARM Macro Assembler    Page 10 Alphabetic symbol ordering
Absolute symbols

      At line 163 in file SAM7.s
      At line 175 in file SAM7.s
      At line 176 in file SAM7.s
      At line 182 in file SAM7.s

PMC_MOR 00000020

Symbol: PMC_MOR
   Definitions
      At line 62 in file defines.s
   Uses
      At line 142 in file SAM7.s
Comment: PMC_MOR used once
PMC_MOR_Val 00000601

Symbol: PMC_MOR_Val
   Definitions
      At line 81 in file defines.s
   Uses
      At line 141 in file SAM7.s
      At line 145 in file SAM7.s

PMC_MOSCEN 00000001

Symbol: PMC_MOSCEN
   Definitions
      At line 67 in file defines.s
   Uses
      At line 145 in file SAM7.s
Comment: PMC_MOSCEN used once
PMC_MOSCS 00000001

Symbol: PMC_MOSCS
   Definitions
      At line 77 in file defines.s
   Uses
      At line 147 in file SAM7.s
Comment: PMC_MOSCS used once
PMC_MUL 07FF0000

Symbol: PMC_MUL
   Definitions
      At line 73 in file defines.s
   Uses
      At line 152 in file SAM7.s
Comment: PMC_MUL used once
PMC_OSCBYPASS 00000002

Symbol: PMC_OSCBYPASS
   Definitions
      At line 68 in file defines.s
   Uses
      None
Comment: PMC_OSCBYPASS unused
PMC_OSCOUNT 0000FF00

Symbol: PMC_OSCOUNT
   Definitions
      At line 69 in file defines.s



ARM Macro Assembler    Page 11 Alphabetic symbol ordering
Absolute symbols

   Uses
      None
Comment: PMC_OSCOUNT unused
PMC_OUT 0000C000

Symbol: PMC_OUT
   Definitions
      At line 72 in file defines.s
   Uses
      None
Comment: PMC_OUT unused
PMC_PCER 00000010

Symbol: PMC_PCER
   Definitions
      At line 61 in file defines.s
   Uses
      At line 266 in file SAM7.s
      At line 272 in file SAM7.s
      At line 293 in file SAM7.s

PMC_PLLCOUNT 00003F00

Symbol: PMC_PLLCOUNT
   Definitions
      At line 71 in file defines.s
   Uses
      None
Comment: PMC_PLLCOUNT unused
PMC_PLLR 0000002C

Symbol: PMC_PLLR
   Definitions
      At line 64 in file defines.s
   Uses
      At line 154 in file SAM7.s
Comment: PMC_PLLR used once
PMC_PLLR_Val 00191C05

Symbol: PMC_PLLR_Val
   Definitions
      At line 82 in file defines.s
   Uses
      At line 152 in file SAM7.s
      At line 153 in file SAM7.s

PMC_PRES 0000001C

Symbol: PMC_PRES
   Definitions
      At line 76 in file defines.s
   Uses
      At line 177 in file SAM7.s
Comment: PMC_PRES used once
PMC_SETUP 00000001

Symbol: PMC_SETUP
   Definitions
      At line 80 in file defines.s



ARM Macro Assembler    Page 12 Alphabetic symbol ordering
Absolute symbols

   Uses
      At line 137 in file SAM7.s
Comment: PMC_SETUP used once
PMC_SR 00000068

Symbol: PMC_SR
   Definitions
      At line 66 in file defines.s
   Uses
      At line 146 in file SAM7.s
      At line 157 in file SAM7.s
      At line 179 in file SAM7.s
      At line 184 in file SAM7.s

PMC_USBDIV 30000000

Symbol: PMC_USBDIV
   Definitions
      At line 74 in file defines.s
   Uses
      None
Comment: PMC_USBDIV unused
RAM_BASE 00200000

Symbol: RAM_BASE
   Definitions
      At line 16 in file defines.s
   Uses
      None
Comment: RAM_BASE unused
RSTC_BASE FFFFFD00

Symbol: RSTC_BASE
   Definitions
      At line 33 in file defines.s
   Uses
      None
Comment: RSTC_BASE unused
RSTC_MR 00000008

Symbol: RSTC_MR
   Definitions
      At line 34 in file defines.s
   Uses
      None
Comment: RSTC_MR unused
RSTC_MR_Val A5000401

Symbol: RSTC_MR_Val
   Definitions
      At line 38 in file defines.s
   Uses
      None
Comment: RSTC_MR_Val unused
RSTC_SETUP 00000001

Symbol: RSTC_SETUP
   Definitions
      At line 37 in file defines.s



ARM Macro Assembler    Page 13 Alphabetic symbol ordering
Absolute symbols

   Uses
      None
Comment: RSTC_SETUP unused
SVC_Stack_Size 00000008

Symbol: SVC_Stack_Size
   Definitions
      At line 19 in file defines.s
   Uses
      At line 26 in file defines.s
      At line 242 in file SAM7.s

UND_Stack_Size 00000000

Symbol: UND_Stack_Size
   Definitions
      At line 18 in file defines.s
   Uses
      At line 26 in file defines.s
      At line 222 in file SAM7.s

USART0_BASE FFFC0000

Symbol: USART0_BASE
   Definitions
      At line 119 in file defines.s
   Uses
      At line 40 in file util.s
      At line 48 in file util.s
      At line 299 in file SAM7.s
      At line 304 in file SAM7.s
      At line 309 in file SAM7.s
      At line 318 in file SAM7.s
      At line 322 in file SAM7.s

USART_BRGR 00000020

Symbol: USART_BRGR
   Definitions
      At line 124 in file defines.s
   Uses
      At line 320 in file SAM7.s
Comment: USART_BRGR used once
USART_CR 00000000

Symbol: USART_CR
   Definitions
      At line 120 in file defines.s
   Uses
      At line 301 in file SAM7.s
      At line 325 in file SAM7.s

USART_CSR 00000014

Symbol: USART_CSR
   Definitions
      At line 122 in file defines.s
   Uses
      At line 49 in file util.s



ARM Macro Assembler    Page 14 Alphabetic symbol ordering
Absolute symbols

Comment: USART_CSR used once
USART_IDR 0000000C

Symbol: USART_IDR
   Definitions
      At line 125 in file defines.s
   Uses
      At line 306 in file SAM7.s
Comment: USART_IDR used once
USART_MR 00000004

Symbol: USART_MR
   Definitions
      At line 121 in file defines.s
   Uses
      At line 315 in file SAM7.s
Comment: USART_MR used once
USART_THR 0000001C

Symbol: USART_THR
   Definitions
      At line 123 in file defines.s
   Uses
      At line 42 in file util.s
Comment: USART_THR used once
USR_Stack_Size 00000400

Symbol: USR_Stack_Size
   Definitions
      At line 23 in file defines.s
   Uses
      At line 30 in file SAM7.s
      At line 253 in file SAM7.s

WDT_BASE FFFFFD40

Symbol: WDT_BASE
   Definitions
      At line 54 in file defines.s
   Uses
      None
Comment: WDT_BASE unused
WDT_MR 00000004

Symbol: WDT_MR
   Definitions
      At line 55 in file defines.s
   Uses
      None
Comment: WDT_MR unused
WDT_MR_Val 00008000

Symbol: WDT_MR_Val
   Definitions
      At line 57 in file defines.s
   Uses
      None
Comment: WDT_MR_Val unused
WDT_SETUP 00000001



ARM Macro Assembler    Page 15 Alphabetic symbol ordering
Absolute symbols


Symbol: WDT_SETUP
   Definitions
      At line 56 in file defines.s
   Uses
      None
Comment: WDT_SETUP unused
98 symbols
513 symbols in table
